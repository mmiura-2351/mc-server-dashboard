# 実装ギャップ分析

**目的**: このドキュメントは、既存実装とARCHITECTURE.md、PHILOSOPHY.md、WORKFLOW.mdで提案されているアーキテクチャとの間のすべての差異を特定します。

**作成日**: 2025-12-26

---

## 要約

既存実装は**本番環境対応のPython/FastAPI + Next.jsアプリケーション**で、洗練された機能を持っています。提案されているアーキテクチャは、Node.js/NestJS + TypeScriptへの**完全な技術スタック変更**を表しています。

**重要な発見**: 既存実装には、提案されているアーキテクチャドキュメントに**反映されていない多くの機能と設計パターン**があります。

---

## 1. 技術スタックの違い

### バックエンド

| コンポーネント | 既存実装 | 提案アーキテクチャ | カテゴリ |
|-----------|------------------------|----------------------|----------|
| **言語** | Python 3.13+ | Node.js + TypeScript | ❌ 意図的な変更 |
| **フレームワーク** | FastAPI 0.115+ | NestJS | ❌ 意図的な変更 |
| **データベース** | SQLite（ファイルベース） | PostgreSQL | ❌ 意図的な変更 |
| **キャッシュ/セッション** | なし | Redis | ⚠️ 新規追加 |
| **ORM** | SQLAlchemy 2.0+ | TypeORM | ❌ 意図的な変更 |
| **認証ライブラリ** | python-jose + passlib | @nestjs/passport + passport-jwt | ❌ 意図的な変更 |
| **パスワードハッシュ** | bcrypt（passlibを通じて） | bcrypt | ✅ 同じ |
| **WebSocket** | FastAPIネイティブWebSocket | Socket.io | ❌ 意図的な変更 |
| **プロセス管理** | subprocess（ダブルフォークデーモン） | child_process + pm2 | ❌ 意図的な変更 |
| **非同期ランタイム** | asyncio + aiofiles | Node.jsネイティブasync/await | ❌ 意図的な変更 |
| **テスト** | pytest + pytest-asyncio | Jest/Vitest（未指定） | ⚠️ 未指定 |
| **リンター/フォーマッター** | Ruff 0.11+ | ESLint + Prettier（未指定） | ⚠️ 未指定 |
| **型チェック** | MyPy 1.13（strictモード） | TypeScript（strictモード） | ❌ 意図的な変更 |
| **パッケージマネージャー** | UV（モダンPython） | npm/yarn/pnpm（未指定） | ⚠️ 未指定 |

### フロントエンド

| コンポーネント | 既存実装 | 提案アーキテクチャ | カテゴリ |
|-----------|------------------------|----------------------|----------|
| **フレームワーク** | Next.js 15.4 + React 19 | Next.js + React | ✅ 同じ |
| **レンダリング** | SSR + CSR（App Router） | SSR（ドキュメント記載） | ⚠️ 不完全（CSR未記載） |
| **状態管理** | React Context API（3つのcontext） | zustand/redux（提案） | ❌ 異なるアプローチ |
| **APIクライアント** | Fetch API + neverthrow Result | react-query/swr（提案） | ❌ 異なるアプローチ |
| **スタイリング** | CSSモジュール（21ファイル） | Tailwind CSS（提案） | ❌ 意図的な変更 |
| **WebSocketクライアント** | なし（ポーリングベース） | socket.io-client（提案） | ⚠️ 新規追加 |
| **UIライブラリ** | カスタムコンポーネント | shadcn/uiまたはMUI（提案） | ⚠️ 新規追加 |
| **i18n** | カスタムLanguageContext（en/ja） | 言及なし | ❗ ドキュメントに欠落 |
| **セキュリティ** | カスタムInputSanitizer + DOMPurify | 言及なし | ❗ ドキュメントに欠落 |
| **テスト** | Vitest + React Testing Library | 未指定 | ⚠️ 未指定 |

---

## 2. アーキテクチャパターンの違い

### 既存実装
- **モノリシックAPI**: 単一のFastAPIアプリケーション
- **サービス指向**: 15以上の専門サービス
- **リポジトリパターン**: SQLAlchemyモデルをリポジトリとして使用
- **依存性注入**: FastAPIの組み込みDI
- **ミドルウェア**: カスタム監査、パフォーマンス、CORSミドルウェア
- **ライフサイクル管理**: ヘルスチェック付きグレースフル起動/シャットダウン

### 提案アーキテクチャ
- **3層アーキテクチャ**: API/フロントエンドの完全分離
- **モジュラーバックエンド**: NestJSモジュールシステム
- **マイクロサービス対応**: 言及されているが詳細なし
- **APIファースト設計**: コントラクトファーストアプローチ

### ギャップ分析
| 側面 | 既存 | 提案 | ステータス |
|--------|----------|----------|--------|
| サービス層 | ✅ 実装済み（15以上のサービス） | ✅ ドキュメント化 | ✅ 整合性あり |
| リポジトリパターン | ✅ SQLAlchemyモデル | ✅ TypeORMリポジトリ | ✅ 整合性あり |
| ミドルウェア | ✅ 監査 + パフォーマンス | ⚠️ 詳細なし | ⚠️ ドキュメント不完全 |
| ヘルスチェック | ✅ マルチサービスヘルスエンドポイント | ✅ 言及あり | ⚠️ ドキュメント不完全 |
| グレースフルシャットダウン | ✅ 実装済み | ⚠️ 言及なし | ❗ ドキュメントに欠落 |

---

## 3. 機能のギャップ

### 3.1 既存実装にあるが提案ドキュメントにない機能

#### ❗ 重要な欠落機能

1. **監査ログシステム**
   - **既存**: 包括的な監査証跡:
     - ユーザーアクション追跡
     - IPアドレスログ
     - 機密フィールドフィルタリング
     - 重要アクションのフラグ付け
     - リクエストスコープのコンテキスト追跡（ContextVars）
   - **提案ドキュメント**: 言及なし
   - **影響**: 高 - コンプライアンスとセキュリティに不可欠

2. **パフォーマンス監視ミドルウェア**
   - **既存**: リクエストタイミング、低速リクエスト検出、メトリクス集計
   - **提案ドキュメント**: 基本的な「Prometheusメトリクスエンドポイント」のみ言及
   - **影響**: 中 - 本番運用に重要

3. **ファイル編集履歴システム**
   - **既存**: ロールバック付きの完全なバージョン履歴
   - **提案ドキュメント**: 言及なし
   - **影響**: 高 - サーバー管理に重要な機能

4. **サーバー設定テンプレート**
   - **既存**: 継承付きテンプレートCRUD
   - **提案ドキュメント**: 言及なし
   - **影響**: 中 - ユーザー体験の向上

5. **データベース永続化スケジューラー**
   - **既存**:
     - DB永続化されたバックアップスケジューラー
     - バージョン更新スケジューラー
     - スケジュール監査ログ
   - **提案ドキュメント**: 言及なし
   - **影響**: 高 - コア機能

6. **グループ管理システム**
   - **既存**: RCON同期付きOPグループとホワイトリストグループ
   - **提案ドキュメント**: 言及なし
   - **影響**: 中 - マルチプレイヤーサーバーに重要

7. **Minecraftバージョン管理**
   - **既存**:
     - データベースキャッシュされたバージョン（Vanilla、Paper、Forge）
     - ビルド番号追跡
     - スケジュールされたバージョン検出
     - API統合（Mojang、PaperMC）
   - **提案ドキュメント**: 言及なし
   - **影響**: 高 - サーバー作成に不可欠

8. **Java互換性マトリックス**
   - **既存**:
     - バージョン固有のJava要件
     - 複数Javaパス設定（8、16、17、21）
     - Java検出システム
   - **提案ドキュメント**: 言及なし
   - **影響**: 高 - サーバー起動に必要

9. **デーモンプロセスアーキテクチャ**
   - **既存**: ダブルフォークUnixデーモン:
     - 完全なプロセス分離
     - ファイルディスクリプタのクリーンアップ
     - PIDファイル永続化
     - API再起動時の自動復旧
   - **提案ドキュメント**: 一般的な「プロセス制御」のみ言及
   - **影響**: 重要 - コアサーバー管理アプローチ

10. **セキュリティ機能**
    - **既存**:
      - パストラバーサル防止（多層）
      - アーカイブ展開検証（zip爆弾防止）
      - 予約名チェック（Windows互換性）
      - SafeName パターン検証
      - サイズ/タイプ検証付きセキュアファイルアップロード
    - **提案ドキュメント**: 一般的な「入力検証」のみ言及
    - **影響**: 重要 - セキュリティファースト設計

11. **接続監視（フロントエンド）**
    - **既存**:
      - 指数バックオフ付きヘルスチェックサービス
      - ダウンタイム追跡
      - ビジュアル接続ステータスインジケーター
    - **提案ドキュメント**: 言及なし
    - **影響**: 中 - ユーザー体験の向上

12. **国際化（i18n）**
    - **既存**:
      - 英語と日本語のサポート
      - カスタムLanguageContext
      - 遅延ロードされた翻訳ファイル
      - エラーメッセージ翻訳
    - **提案ドキュメント**: 言及なし
    - **影響**: 中 - アクセシビリティに重要

13. **ドキュメントシステム**
    - **既存**:
      - /public/docs/のMarkdownベースのドキュメント
      - フロントマターメタデータ
      - シンタックスハイライト
      - 多言語ドキュメント
      - クライアントサイド検索
    - **提案ドキュメント**: 言及なし
    - **影響**: 低 - あると便利な機能

14. **ユーザー承認ワークフロー**
    - **既存**:
      - is_approvedフラグ
      - 新規ユーザーに管理者承認が必要
      - 承認ステータスに基づくアクセス制御
    - **提案ドキュメント**: 言及なし
    - **影響**: 中 - セキュリティ/管理者制御

15. **リフレッシュトークン無効化**
    - **既存**:
      - データベース永続化されたリフレッシュトークン
      - ユーザーごとに1つのアクティブトークンのみ
      - ログアウト/リフレッシュ時のトークン無効化
    - **提案ドキュメント**: 一般的な「JWTトークン」のみ言及
    - **影響**: 高 - セキュリティ機能

#### ⚠️ 実装の違い

16. **リアルタイム通信**
    - **既存（バックエンド）**: FastAPIネイティブWebSocket
    - **既存（フロントエンド）**: ポーリング（遷移中は2秒間隔）
    - **提案**: Socket.io（バックエンドとフロントエンド両方）
    - **影響**: 中 - アーキテクチャ変更

17. **状態管理（フロントエンド）**
    - **既存**: React Context API（軽量）
    - **提案**: zustand/redux（より重いソリューション）
    - **影響**: 低 - Context APIは現在の規模で十分

18. **エラーハンドリングパターン**
    - **既存（フロントエンド）**: neverthrow Result型（型安全）
    - **提案**: 未指定
    - **影響**: 中 - neverthrowはエレガントで型安全

19. **スタイリングアプローチ**
    - **既存**: CSSモジュール（21ファイル、BEMスタイル）
    - **提案**: Tailwind CSS
    - **影響**: 低 - どちらも有効なアプローチ

### 3.2 提案ドキュメントにあるが既存実装にない機能

#### ⚠️ 新規提案機能

1. **Redisキャッシュ/セッションストア**
   - **目的**: セッション管理、キャッシング、Pub/Sub
   - **ステータス**: 既存実装にはなし（SQLiteのみ）
   - **影響**: 中 - スケーラビリティの向上

2. **ネットワーク層（サブドメインルーティング）**
   - **目的**: サブドメイン経由でMinecraftトラフィックをルーティング（aaa.example.net）
   - **ステータス**: データモデル準備済み、実装は未着手
   - **影響**: 高 - 将来機能、フェーズ2として正しくマーク

3. **Kubernetesデプロイ**
   - **目的**: 本番環境オーケストレーション
   - **ステータス**: 既存はsystemdサービスのみ
   - **影響**: 中 - スケーリングには良いが、初期には不要

4. **外部認証（OAuth/OIDC）**
   - **目的**: Google/GitHubログイン
   - **ステータス**: 未実装だが、既存認証システム設計で言及
   - **影響**: 中 - あると便利

5. **通知システム**
   - **目的**: メール、webhook通知
   - **ステータス**: 未実装
   - **影響**: 低 - 将来の機能拡張

6. **高度な監視（Prometheus、OpenTelemetry）**
   - **目的**: 本番環境の可観測性
   - **ステータス**: 基本的なパフォーマンスメトリクスは存在するが、Prometheus形式ではない
   - **影響**: 中 - 本番環境に重要

---

## 4. データモデルの違い

### 既存データベーススキーマ（SQLite）

**提案ドキュメントに記載されていないテーブル:**
1. `RefreshToken` - トークン無効化追跡
2. `Template` - サーバー設定テンプレート
3. `FileEditHistory` - ファイルバージョン履歴
4. `Group` - プレイヤーグループ（OP/ホワイトリスト）
5. `ServerGroup` - サーバーグループの多対多関係
6. `MinecraftVersion` - キャッシュされたバージョンデータ
7. `VersionUpdateLog` - バージョン検出監査証跡
8. `BackupSchedule` - 永続化されたバックアップスケジュール
9. `BackupScheduleLog` - スケジュール変更監査
10. `AuditLog` - 包括的なアクション記録

**提案ドキュメントに記載されているテーブル:**
- Users（✅ 存在）
- Servers（✅ 存在するが、ドキュメントに多くのフィールドが欠落）
- Backups（✅ 存在するが、スケジュール関係が欠落）
- ServerConfiguration（✅ 存在）

### スキーマギャップ

| テーブル/フィールド | 既存 | 提案ドキュメント | ステータス |
|-------------|----------|---------------|--------|
| User.is_approved | ✅ | ❌ | ❗ 欠落 |
| User.role | ✅（enum: admin/operator/user） | ✅ 言及あり | ✅ 整合性あり |
| Server.template_id | ✅ | ❌ | ❗ 欠落 |
| Server.owner_id | ✅ | ❌ | ❗ 欠落 |
| Server.is_deleted | ✅（論理削除） | ❌ | ❗ 欠落 |
| Server.subdomain | ❌ | ✅（将来） | ✅ 正しい（フェーズ2） |
| Backup.backup_type | ✅（manual/scheduled/pre-update） | ❌ | ❗ 欠落 |
| Backup.status | ✅ | ❌ | ❗ 欠落 |

---

## 5. セキュリティアプローチの違い

### 既存実装のセキュリティ機能

**強み:**
1. **多層パス検証**
   - SafeName正規表現パターン
   - 予約名チェック
   - パストラバーサル防止
   - Tarメンバー検証

2. **アーカイブセキュリティ**
   - サイズ制限（最大1GBアーカイブ）
   - ファイル数制限（最大10,000）
   - 圧縮率検証（zip爆弾防止）
   - 個別ファイルサイズ制限（最大100MB）
   - シンボリックリンクとデバイスファイルの拒否

3. **入力サニタイゼーション（フロントエンド）**
   - XSS防止（HTMLエンコーディング）
   - HTMLコンテンツ用DOMPurify
   - パストラバーサル防止
   - パスワード強度検証

4. **監査ログ**
   - すべてのユーザーアクションを記録
   - IPアドレス追跡
   - 機密フィールドフィルタリング（password、token、secret）
   - 重要アクションのフラグ付け

5. **トークンセキュリティ**
   - リフレッシュトークン無効化
   - ユーザーごとに1つのアクティブトークンのみ
   - シークレットキー検証（最小32文字）
   - デフォルトシークレット不可

### 提案ドキュメントのセキュリティ機能

**言及あり:**
1. httpOnlyクッキーのJWTトークン
2. RBAC（Admin/Operator/Viewerロール）
3. OAuth2/OIDC統合（将来）
4. APIレート制限
5. 入力検証（一般的）
6. ORM経由のSQLインジェクション防止

**言及なし:**
- アーカイブ展開検証
- パストラバーサル防止の詳細
- 監査ログシステム
- フロントエンド入力サニタイゼーション
- トークン無効化メカニズム
- 多層セキュリティ検証

### ギャップ分析
- **提案ドキュメントは高レベル** - 重要なセキュリティ実装詳細が欠落
- **既存実装は本番グレード** - エンタープライズセキュリティプラクティス

---

## 6. デプロイの違い

### 既存デプロイ

**バックエンド:**
- systemdサービス（`mc-server-dashboard-api.service`）
- uvicorn ASGIサーバー
- 環境ベース設定（.env）
- デプロイスクリプト（service-manager.sh、deploy.sh）

**フロントエンド:**
- systemdサービス（`mc-dashboard-ui.service`）
- Next.jsスタンドアロンビルド
- セキュリティヘッダー設定済み
- ヘルスチェックエンドポイント

**欠落:**
- Dockerイメージ
- Docker Composeファイル
- Kubernetesマニフェスト

### 提案デプロイ

**ドキュメント化:**
- Docker + Docker Compose（開発）
- Kubernetes（本番）
- Ingressコントローラー
- データベース用StatefulSets

**ドキュメントから欠落:**
- systemdサービス設定
- 直接ホストデプロイ
- ヘルスチェックエンドポイント
- グレースフルシャットダウン手順

### ギャップ分析
- **既存は直接ホストデプロイに焦点** （systemd）
- **提案はコンテナ化に焦点** （Docker/K8s）
- **両方のアプローチが有効** - ドキュメントにsystemdオプションを記載すべき

---

## 7. テスト戦略の違い

### 既存実装

**バックエンド（Python）:**
- 非同期サポート付きpytest
- カバレッジ目標: 明示的に設定されていない
- テスト並列化（pytest-xdist）
- テストカテゴリ: unit、integration、infrastructure
- 包括的なテストスイート

**フロントエンド（React）:**
- Vitest + React Testing Library
- カバレッジ目標: 75-80%
- 74テストファイル
- コンポーネント + サービス + ユーティリティテスト
- HTMLカバレッジレポート

### 提案ドキュメント

**テスト要件:**
- **最小カバレッジ: 95%**
- **クリティカルパス: 100%**
- テストタイプ: ユニット、統合、E2E
- テスト品質: 保守可能、信頼性、フレイキーテストなし

### ギャップ分析
- **提案カバレッジ目標（95%）は既存（75-80%）より高い**
- **既存実装は提案基準を満たしていない可能性**
- **E2Eテストは未実装** 既存コードベースに
- **テスト品質基準は整合** （両方とも保守性を強調）

### 推奨事項
- **PHILOSOPHY.mdを更新**: 既存の75-80%カバレッジを開始点として認識
- **現実的な移行パスを設定**: 75% → 85% → 95%
- **E2Eテスト戦略を文書化**（Playwright、Cypressなど）

---

## 8. 開発ワークフローの違い

### 既存実装

**Git/バージョン管理:**
- 初期化されていない（新規プロジェクトセットアップ）
- ブランチ保護なし
- CI/CD設定なし
- コミットメッセージ規約の強制なし

**コード品質:**
- Python用Ruff（リンティング + フォーマット）
- 型チェック用MyPy（strictモード）
- TypeScript/React用ESLint
- フロントエンドフォーマット用Prettier

### 提案ワークフロー（WORKFLOW.md）

**Git戦略:**
- main/developハイブリッドモデル
- Conventional Commits必須
- mainのブランチ保護
- CI/CD必須（GitHub Actions）
- Squash and merge

**コード品質:**
- 厳格なルールのリンター（警告ゼロ）
- ビルド時に強制される型チェック
- プレコミットフック
- 違反時にCI/CDパイプラインがブロック

### ギャップ分析
- **既存にはGitワークフローなし** - 新規スタート
- **提案ワークフローは包括的** - 実装準備完了
- **コード品質ツールが異なる** - Ruff（Python）対ESLint（TypeScript）
- **移行不要** - 新規リポジトリは提案ワークフローに従える

---

## 9. パフォーマンス考慮事項

### 既存実装

**最適化:**
1. データベース接続プーリング
2. WALモード付きSQLite（設定されている場合）
3. 全体的に非同期I/O（asyncio、aiofiles）
4. 設定可能なサイズのログキュー（500-10000）
5. データベースバッチ操作（batch_size: 100）
6. バージョンキャッシング（API呼び出しの代わりにDB）
7. フロントエンド遅延ロード（LazyServerDashboardなど）
8. Next.jsスタンドアロンビルド
9. 開発環境でのTurbopack

**監視:**
- リクエストタイミングミドルウェア
- 低速リクエスト検出（>1秒設定可能）
- パフォーマンスメトリクスエンドポイント

### 提案ドキュメント

**スケーラビリティ:**
- 水平スケーリング（ステートレスバックエンド）
- WebSocket同期用Redis Pub/Sub
- データベース接続プーリング
- リソース制限による垂直スケーリング

**言及なし:**
- ログキューサイズ設定
- データベースバッチサイズ調整
- バージョンキャッシング戦略
- フロントエンドコード分割

### ギャップ分析
- **既存には本番対応の最適化** がドキュメント化されていない
- **提案ドキュメントはインフラスケーリングに焦点** （K8s、Redis）
- **欠落: アプリケーションレベルの最適化詳細**

---

## 10. 設定管理

### 既存実装（.env）

**バックエンド設定:**
```
SECRET_KEY（検証: 最小32文字）
ALGORITHM（デフォルト: HS256）
ACCESS_TOKEN_EXPIRE_MINUTES（デフォルト: 30）
REFRESH_TOKEN_EXPIRE_DAYS（デフォルト: 30）
DATABASE_URL
DATABASE_MAX_RETRIES（1-10、デフォルト: 3）
DATABASE_RETRY_BACKOFF（0.01-5.0、デフォルト: 0.1）
DATABASE_BATCH_SIZE（10-1000、デフォルト: 100）
SERVER_LOG_QUEUE_SIZE（100-10000、デフォルト: 500）
JAVA_CHECK_TIMEOUT（1-60秒、デフォルト: 5）
JAVA_8_PATH、JAVA_16_PATH、JAVA_17_PATH、JAVA_21_PATH
JAVA_DISCOVERY_PATHS
CORS_ORIGINS
ENVIRONMENT（development|production|testing）
KEEP_SERVERS_ON_SHUTDOWN（デフォルト: true）
AUTO_SYNC_ON_STARTUP（デフォルト: true）
```

**フロントエンド設定:**
```
NEXT_PUBLIC_API_URL（デフォルト: http://localhost:8000）
PORT（デフォルト: 3000）
NODE_ENV
```

### 提案ドキュメント

**設定:**
- 環境ベース設定が言及されている
- 特定の変数はリストされていない
- 検証ルールがドキュメント化されていない

### ギャップ分析
- **既存には20以上の設定オプション** が検証付きで存在
- **提案ドキュメントは高レベル** - 特定の設定変数が欠落
- **ドキュメント化が必要**: すべての環境変数と検証ルール

---

## 調査結果の要約

### 提案ドキュメントの重大なギャップ

#### ❌ 完全に欠落している機能（既存 → ドキュメント化されていない）
1. 監査ログシステム
2. ロールバック付きファイル編集履歴
3. サーバー設定テンプレート
4. データベース永続化スケジューラー
5. グループ管理（OP/ホワイトリスト）
6. Minecraftバージョン管理 + キャッシング
7. Java互換性マトリックス
8. デーモンプロセスアーキテクチャ（ダブルフォーク）
9. アーカイブセキュリティ検証（zip爆弾防止）
10. 接続監視（フロントエンド）
11. 国際化（i18n）
12. ドキュメントシステム
13. ユーザー承認ワークフロー
14. リフレッシュトークン無効化
15. パフォーマンス監視ミドルウェア

#### ⚠️ 不完全なドキュメント
1. セキュリティ実装詳細（パス検証、アーカイブ安全性）
2. エラーハンドリングパターン（neverthrow未記載）
3. ヘルスチェック実装
4. グレースフルシャットダウン手順
5. 設定変数と検証
6. フロントエンドCSR機能（SSRのみ記載）
7. 状態管理アプローチ（Context API未記載）
8. テストカバレッジの現実（75-80%対提案95%）

#### ❌ 技術スタックの不整合
1. バックエンド: Python/FastAPI → NestJS/TypeScript（意図的）
2. データベース: SQLite → PostgreSQL（意図的）
3. WebSocket: ネイティブ → Socket.io（意図的）
4. 状態管理: Context → Redux/Zustand（不要な変更）
5. スタイリング: CSSモジュール → Tailwind（意図的）
6. プロセス管理: ダブルフォークデーモン → pm2（意図的）

#### ✅ 正しくドキュメント化された将来機能
1. ネットワーク層（サブドメインルーティング） - フェーズ2
2. Redisキャッシュ/セッション - 新規追加
3. Kubernetesデプロイ - スケーリングパス
4. OAuth/OIDC - 将来の認証

### 推奨事項

1. **ARCHITECTURE.mdを更新**:
   - 既存実装からの欠落機能をすべてドキュメント化
   - 詳細なセキュリティ実装セクションを追加
   - 設定管理の詳細を含める
   - Java互換性要件をドキュメント化
   - デーモンプロセスアーキテクチャの根拠を追加

2. **PHILOSOPHY.mdを更新**:
   - テストカバレッジ目標を調整（95%は目標、75-80%から開始）
   - カバレッジ改善の移行パスをドキュメント化
   - 既存実装からのセキュリティファースト設計原則を追加

3. **新規ドキュメント作成**:
   - SECURITY.md - 詳細なセキュリティプラクティス
   - CONFIGURATION.md - すべての環境変数
   - MIGRATION.md - 既存PythonからNestJSへのパス

4. **技術スタック決定**:
   - **再検討**: Redis（現在の規模では不要）
   - **再検討**: Socket.io対ポーリング（ポーリングは良好に機能）
   - **再検討**: Tailwind対CSSモジュール（CSSモジュールは正常に機能）
   - **維持**: PostgreSQL（マルチユーザーに適している）
   - **維持**: NestJS/TypeScript（言語統一の目標）

---

**最終更新日**: 2025-12-26
